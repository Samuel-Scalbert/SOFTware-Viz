<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Agent-Based Modeling for Studying the Spontaneous Emergence of Money</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Mattia</forename><forename type="middle">Di</forename><surname>Russo</surname></persName>
							<email>dirusso.mattia@gmail.com</email>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">Université Côte d&apos;Azur</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<orgName type="institution" key="instit3">I3S</orgName>
								<address>
									<settlement>Sophia Antipolis</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Zakaria</forename><surname>Babutsidze</surname></persName>
							<email>zakaria.babutsidze@skema.edu</email>
							<affiliation key="aff1">
								<orgName type="institution">SKEMA Business School Sophia Antipolis</orgName>
								<address>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Célia</forename><surname>Da Costa Pereira</surname></persName>
							<email>celia.da-costa-pereira@univ-cotedazur.fr</email>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Université Côte d&apos;Azur</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<orgName type="institution" key="instit3">I3S</orgName>
								<address>
									<settlement>Sophia Antipolis</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Maurizio</forename><surname>Iacopetta</surname></persName>
							<email>maurizio.iacopetta@skema.edu</email>
							<affiliation key="aff3">
								<orgName type="institution">SKEMA Business School Sophia Antipolis</orgName>
								<address>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Andrea</forename><forename type="middle">G B</forename><surname>Tettamanzi</surname></persName>
							<email>andrea.tettamanzi@univ-cotedazur.fr</email>
							<affiliation key="aff4">
								<orgName type="institution" key="instit1">Université Côte d&apos;Azur</orgName>
								<orgName type="institution" key="instit2">Inria</orgName>
								<orgName type="institution" key="instit3">CNRS</orgName>
								<orgName type="institution" key="instit4">I3S</orgName>
								<address>
									<settlement>Sophia Antipolis</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Agent-Based Modeling for Studying the Spontaneous Emergence of Money</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">7077EC27A25C658F7608017DBAC3F59C</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-04-12T14:48+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Search and Money</term>
					<term>Reinforcement Learning</term>
					<term>Social Simulation</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>A central question in economics is how a society accepts money, defined as a commodity used as a medium of exchange, as an unplanned outcome of the individual interactions. This question has been approached theoretically in the literature and investigated by means of agent-based modeling. While an important aspect of the theory is the individual's speculative behavior, that is, the acceptance of money despite a potential short-term loss, previous work has been unable to reproduce it with boundedly rational agents. We investigate the reasons for the failure of previous work to have boundedly rational agents learn speculative strategies. Starting with an agent-based model proposed in the literature, where the intelligence of the agents is guided by a learning classifier system that is shown to be capable of learning trade strategies (core strategies) that involve short sequences of trades, we test several modifications of the original model and we come up with a set of assumptions that enable the spontaneous emergence of speculative strategies, which explain the emergence of money even when the agents have bounded rationality.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I. INTRODUCTION AND RELATED WORK</head><p>While there is disagreement among economists about the origin of money, some have conjectured that it emerged spontaneously from trading activities among selfish agents with bounded rationalities, without any particular supervision <ref type="bibr" target="#b8">[9]</ref>, <ref type="bibr" target="#b10">[11]</ref>, <ref type="bibr" target="#b12">[13]</ref>, <ref type="bibr" target="#b18">[19]</ref>, causing a certain number of goods to become acceptable to all actors in the trade, i.e., to become money.</p><p>Due to its complexity, this problem has been tackled using agent-based modeling, which is the computational study, carried out by means of simulation, of economies that are modeled as evolving systems of autonomous interacting agents <ref type="bibr" target="#b11">[12]</ref>, <ref type="bibr" target="#b14">[15]</ref>- <ref type="bibr" target="#b16">[17]</ref>. An agent-based model makes it possible to study the interaction among agents, even when these have considerable differences in preferences and skills.</p><p>In the seminal model of Kiyotaki and Wright <ref type="bibr" target="#b7">[8]</ref> rational agents of different types trade their goods, with the ultimate goal of consuming their preferred good; stationary Nash equilibria are studied to check whether particular commodities can emerge as a medium of exchange. Duffey et al. <ref type="bibr" target="#b3">[4]</ref> conducted experiments aimed at providing as close an approximation of the Kyiotaki-Wright environment as possible in the laboratory. The results showed that "subjects tend to play 'fundamental' strategies rather than 'speculative' strategies, even in contexts where speculative strategies would yield better gains." Marimon et al. <ref type="bibr" target="#b9">[10]</ref> expand Kiyotaki and Wright's study by assuming artificially intelligent agents instead of rational ones, and making them learn their strategies adaptively, by modeling them as classifier systems <ref type="bibr" target="#b5">[6]</ref>, <ref type="bibr" target="#b17">[18]</ref>. They found that the system always converges to a stationary Nash equilibrium, but in economies with multiple equilibria, the only equilibrium that emerges is the one with low storage goods playing the role of money (Kiyotaki and Wright's "fundamental equilibrium").</p><p>Babutsidze and Iacopetta <ref type="bibr" target="#b0">[1]</ref> study the conditions under which individuals can learn to play speculative strategies to accept a high-storage-cost good as money, whether the agents are fully or boundedly-rational. Their experimental study concluded that, contrary to what Kiyotaki and Wright suggested, when artificial agents or real people are asked to make decisions in such a trade environment, the low-return object is rarely accepted as money. They also pointed out some shortcomings of Marimon et al.'s model <ref type="bibr" target="#b9">[10]</ref>, which call for an analysis and motivate our proposal of an improvement of the agents' learning capabilities so that they can learn complex strategies.</p><p>After accurately replicating the different models proposed in the literature, we thus extend them and make further experiments in order to improve the agents' faculty of learning speculative strategies, an objective that is lacking in <ref type="bibr" target="#b0">[1]</ref> and <ref type="bibr" target="#b9">[10]</ref>. Our goal is to find out possible limitations of the agents' artificial intelligence. The results we obtain are very promising, even if more can still be done on this subject.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>II. ECONOMIC MODEL</head><p>The Economic Model we use goes back to Kyiotaki and Wright <ref type="bibr" target="#b7">[8]</ref>. For a more detailed discussion of the economic environment, we direct the reader to some relevant recent literature in Economics <ref type="bibr" target="#b2">[3]</ref>, <ref type="bibr" target="#b6">[7]</ref>.</p><p>Time is discrete and infinite and, at each time step, there are three indivisible commodities called Good 1, Good 2 and Good 3. There is a continuum of infinitely lived agents of three types, with equal proportions of Type 1, Type 2, and Type 3, that specialize in both consumption and production: type i agents derive utility only from the consumption of Good i and are able to produce only Good i * = i + 1 mod 3 = i.</p><p>All goods are storable at a cost, but agents can store only one unit at a time and, since goods are indivisible, only one good at a time. Storage costs are type-and good-specific. Let c ij denote the cost (in terms of instantaneous disutility) to Type i of storing Good j. The assumtion is made that c i3 &gt; c i2 &gt; c i1 &gt; 0 for all i.</p><p>Type i's expected discount lifetime utility is given by</p><formula xml:id="formula_0">E = ∞ t=0 β t   I U i (t)U i -I D i * (t)D i + 3 j=1 I c ij (t)c ij   ,<label>(1)</label></formula><p>where U i denotes the instantaneous utility from consuming Good i, D i the instantaneous disutility from producing good i β ∈ (0, 1) is the discount factor (common across types), I U i (t) is an indicator function that equals one if the agent "eats" its consumption Good i, zero otherwise; I D i * (t) equals one if it produces its production Good i * , zero otherwise; and I c ij (t) equals one if it stores any good j, zero otherwise, at the end of period t.</p><p>We assume that the net utility of consuming plus producing, u i = U i -D i , is large enough that agents will not want to drop out of the economy, which is is always the case if</p><formula xml:id="formula_1">u i &gt; (c ii * -c ik )/(1 -β), for all i, k.<label>(2)</label></formula><p>At time t, if Type i is lucky enough to acquire its consumption Good i, it will consume it and produce a new unit of Good i * .</p><p>Thus each Type i always has an inventory of exactly one unit of one good other than Good i. At each period, agents are randomly matched in pairs and must decide whether or not to trade bilaterally. Trade always entails a one-for-one swap of inventories, given the physical environment, and occurs if and only if it is mutually agreeable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Agent Behavior</head><p>Each individual chooses a trading strategy to maximize its expected discounted utility, taking as given the strategies of other agents and the inventory distribution p(t). Notice that while this is true in the original model, our goal is to make the agents learn strategies when they are boundedly rational, that is, they don't have knowledge of the other agents' behaviors and of the distribution of goods among all the agents. A trading strategy is a rule determining the circumstances under which an agent is willing to trade.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Equilibrium</head><p>In this environment, the goal is to define the agent's behavior in order to reach a steady-state Nash equilibrium, i.e., a set of trading strategies, one for each type i, together with a steady-state distribution of inventories p, such that (i) the strategy chosen by each individual maximizes its expected utility given the strategies of the others and the distribution p, and (ii) no agent has anything to gain by changing only their own strategy. The goal is to characterize equilibrium for different particular specifications of the production and consumption specialties.</p><p>Let V i (j) be the expected discounted utility for Type i when it exits a trading opportunity with Good j, given that it follows a maximizing strategy; that is, V i (j) is the indirect utility of leaving with good j. When i exits with its own consumption Good i, it consumes it and immediately produces a new unit of Good i * , which yields the instantaneous utility u i = U i -D i , plus the indirect utility of storing Good i * , i.e., V i (i) = u i + V i (i * ). The indirect utility for Type i of storing Good j = i is described by Bellman's equation of dynamic programming <ref type="bibr" target="#b1">[2]</ref>:</p><formula xml:id="formula_2">V i (j) = -c ij + maxβE[V i (j ) | j],<label>(3)</label></formula><p>where E[V i (j ) | j] is the expectation of V i at next period's random state j , conditional on j, and the maximization is over strategies.</p><p>In equilibrium, agents of the same type never trade, since neither can prefer what the other has. Under Assumption 2, each Type i will accept Good i, consume it, and produce a new unit of Good i * whenever it has the opportunity. That is, for all i,</p><formula xml:id="formula_3">max j V i (j) = V i (i) = u i -V i (i).</formula><p>Since Type i always wants to consume Good i and produce Good i * , a trade always occurs whenever Type i with Good j meets Type j with Good i.</p><p>An algorithm for finding equilibria is described in <ref type="bibr" target="#b7">[8]</ref>, which essentially performs an exhaustive search over the strategy profiles to completely characterize the set of equilibria. For certain parameter values, there will exist one equilibrium, referred to as a fundamental equilibrium since agents always prefer a lower-storage-cost commodity to a higher-storage-cost commodity, unless the latter is their own consumption good. For other parameter values there exists another equilibrium, referred to as a speculative equilibrium, since sometimes agents trade a lower-for a higher-storage-cost commodity not because they wish to consume it, but because they rationally expect that this is the best way to ultimately trade for another good that they do want to consume, that is because it is more marketable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Fundamental Strategy</head><p>The fundamental strategies are described by V i (i) = max j V i (j) for all i (agents always prefer their consumption good) and the inequalities</p><formula xml:id="formula_4">V 1 (2) &gt; V 1 (3), V 2 (1) &gt; V 2 (3), and V 3 (1) &gt; V 3 (2) (otherwise they prefer higher-storage-cost goods).</formula><p>Fundamental strategies are always the best response for Types 2 and 3 agents that only look at fundamentals for and best for Type 1 iff c 13 -c 12 &gt; (p 31 -p 21 )bu 1 , with b = β/3 and p ij equal to the probability for an agent of Type i to own a good of type j.</p><p>The steady-state inventory distribution p may be summarized here by three numbers (since p ii = 0 and j p ij = 1 for all i). For these fundamental strategies, this is given by (p 12 , p 23 , p 31 ) = (1, 1  2 , 1), and therefore these strategies constitute an equilibrium iff c 13 -c 12 &gt; 1 2 bu 1 . Types 1 and 3 always keep their production goods until they can trade directly for their consumption goods, never using indirect trade. Type 2 agents trade their production Good 3 for Good 1 whenever possible, and end up holding each exactly half of the time. They thereby act as middlemen, transferring Good 1 from Type 3 to Type 1 agents.</p><p>Good 1 is the unique medium of exchange, or commodity money, in this equilibrium.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Speculative Strategy</head><p>On the other hand, if c 13 -c 12 &lt; (p 31 -p 21 )bu 1 , fundamental play by all agents does not constitute an equilibrium. The best response by Type 1 to fundamental play, in this case, is to speculate by attempting to trade Good 2 for Good 3, which has a higher storage cost but is also more marketable. Fundamental play is still the best response by Types 2 and 3 and, therefore, the strategies corresponding to</p><formula xml:id="formula_5">V i (i) = max i V i (j) and the in- equalities V 1 (2) &lt; V 1 (3), V 2 (1) &gt; V 2 (3), and V 3 (1) &gt; V 3 (2)</formula><p>also constitute an equilibrium in some other region of the parameter space.</p><p>To sum up, Types 2 and 3 should indeed use fundamental strategies when Type 1 speculates, and Type 1 should speculate iff c 13 -c 12 &lt; (p 31 -p 21 )bu 1 . The inventory distribution implied by these strategies is</p><formula xml:id="formula_6">(p 12 , p 23 , p 31 ) = ( √ 2 2 , √ 2-1, 1</formula><p>), and so speculative equilibrium obtains iff c 13 -</p><formula xml:id="formula_7">c 12 &lt; ( √ 2 - 1)bu 1 .</formula><p>By engaging in speculation, Type 1 agents now also play the role of middlemen in some trades, transferring Good 3 from Type 2 to Type 3. Type 2 agents are still middlemen in other trades, and they continue to use Good 1 as a medium of exchange, while Type 1 uses Good 3 as a medium of exchange. In this equilibrium, we therefore have dual commodity monies, with both the most storable and the least storable goods (i.e., Goods 1 and 3) used to achieve indirect trade in different instances by different individuals.</p><p>No other set of strategies is consistent with equilibrium and, in the intermediate region, where ( √ 2 -1)bu 1 &lt; c 13 -c 12 &lt; 1 2 bu 1 , no pure strategy, steady-state equilibrium exists in which all agents of the same type play the same strategy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E. Boundedly Rational Agents</head><p>Until now we have talked about an environment where individuals are fully informed about what other agents do, and on the current state of the economy. Now, following <ref type="bibr" target="#b0">[1]</ref>, we will analyze the behavior of agents that do not have perfect foresight. Hence, agents are thought of as having a limited capacity to take actions on the basis of forecasted future states of the economy.</p><p>One way to implement agents with bounded rationality is to have them make decisions through a classifier system, as in Marimon et al.'s <ref type="bibr" target="#b9">[10]</ref> implementation of Kiyotaki and Wright's model.</p><p>In the simplest version of Marimon et al.'s <ref type="bibr" target="#b9">[10]</ref> model, agents possess two interdependent classifier systems, one to guide their trading decisions, and the other to guide their consumption decisions. The exchange classifier maps the pre-trade system into a trading decision, while the consumption classifier maps the post-trade state into a consumption decision.</p><p>Conditions on the pre-trade asset holdings of the two agents can be described by a ternary string of 6 digits. Each digit expresses if the given agent holds (1) or does not hold (0) the given product; the "don't care" symbol # matches either state. The first three digits describe the inventory of one trader, the following three describe the inventory of its counterpart. For example, string 100 0## means the first trader has Good 1 in stock, while its counterpart does not have Good 1. After eliminating the redundant alternatives, all possibilities are captured by 72 trade classifiers.</p><p>Consumption classifiers are modeled similarly to the trade classifiers. They represent a string of ternary digits describing the post-trade holdings of the consumer, plus a binary value for the "consume / do not consume" decision. Elimination of the redundant alternatives yields 12 distinct consumption classifiers.</p><p>The time-line of one period in the computational model is as follows. An agent is matched with a randomly selected counterpart. It observes its own asset holdings as well as those of the counterpart. All matching trade classifiers are short-listed and enter the "auction" system, which ranks the classifiers according to their strength and generality (i.e., how many #s they contain). The agent takes the action indicated by the top-ranking exchange classifier. It either proposes to exchange the asset holdings, or refuses to do so. In case both agents agree to exchange their assets, a trade takes place. Following this, post-trade holding is realized and consumption classifiers enter a similar "auction". The top-ranking classifier gives directions on whether to consume or not. In the case of consumption, the agent costlessly produces its production good.</p><p>Storage costs (c i ) for the good the agent holds at the end of the period are subtracted from the utility (u i ) the agent has received during this time period. This net utility affects the strengths of the classifiers that brought the system to its current condition. Most notably, these are the current consumption classifier and the current trade classifier. However, this might also involve other trade classifiers, in particular, those that contributed toward the trade sequence that culminated in the current consumption decision. At this point the period is over and agents enter a new time period with updated asset holdings and classifier strength vectors (S ai (t + 1)).</p><p>A genetic algorithm <ref type="bibr" target="#b4">[5]</ref> is used to optimize a non-exhaustive set of classifiers, which makes it possible to maintain only a subset of all the possible rules. The algorithm adds to the classifier system a random initialization of the population of rules and a mechanism by which such population evolves, which results from the application of four operators: creation, which creates a new classifier from scratch when no classifier matches the current state; mutation, designed to inject sufficient diversity into the range of actions called for by different classifiers in a given situation; specialization and generalization, called randomly with a probability that decreases over time, just after the winning bid has been determined.</p><p>This completes the description of the economic model studied in <ref type="bibr" target="#b7">[8]</ref>, <ref type="bibr" target="#b0">[1]</ref> and <ref type="bibr" target="#b9">[10]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>III. LEARNING SPECULATIVE STRATEGIES</head><p>Experimemts conducted to verify that boundedly-rational agents equipped with a Learning Classifier System could learn fundamental and speculative strategies under the right circumstances, as the theoretical result suggest, gave mixed results <ref type="bibr" target="#b0">[1]</ref>, <ref type="bibr" target="#b9">[10]</ref>: in an economy with low utility reward from consumption, where their behavior should converge to a fundamental equilibrium, the agents are able to learn how to exchange correctly, while in a high-utility scenario, where some agents should learn speculative strategies, they failed at this task.</p><p>Given those premises, our objective was to investigate the assumptions that enable the emergence of speculative strategies in all scenarios.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Validation</head><p>As a preliminary step, we tested the framework we implemented based on the model described above to check if the agents have the correct behavior when they have to learn the fundamental strategy. Those experiments were performed by assuming that the agents are equally distributed, i.e., the population consists of 1/3 of agents of Type 1, 1/3 of agents of Type 2 and 1/3 of agents of Type 3.</p><p>Figure <ref type="figure" target="#fig_0">1</ref> shows the distribution of goods owned by fullyrational agents of Type 1, 2 and 3, respectively, showing convergence to (p 12 , p 23 , p 31 ) = (1, 1  2 , 1), as expected per Section II-C. On the x-axis we have the number of agents holding a certain good, while on the y-axis we have the time period. For Type 2 we do not have a flat line corresponding to exactly 50% of the agents holding Good 1 and 50% holding Good 3, as the theoretical study predicts, because, contrary to the theoretical model, here we have a finite number of agents (100 agents of each type).</p><p>Figure <ref type="figure" target="#fig_2">2</ref> shows the distributions when agents of Type 1 play speculative while Type 2 and 3 play fundamental (which is the result we aim at).</p><p>As already mentioned in Section II-D, when agents play those kinds of strategies, the system has reached an equilibrium on the state (p 12 , p 23 , p 31 ) = (  that after reaching the Nash equilibrium, agents of Type 1 should hold Good 2 with 70% probability (consequently, they should hold Good 3 with 30% probability, since agents cannot hold their consumption good), agents of Type 2 should hold Good 3 with 41% probability, and agents of Type 3 should hold their production Good 1 100% of the time.</p><p>Let's now move on to the experiments with boundedlyrational agents. As anticipated, the classifier system itself works well when it has to make agents learn fundamental strategies only. This is shown in Figures <ref type="figure" target="#fig_3">3</ref> and<ref type="figure">4</ref>. After 500 time periods and 30 model runs, we obtain an overall decision accuracy of 71% without the genetic algorithm and 78% with the genetic algorithm. This outcome is explained by the fact that there is some over-consumption in agents of Type 1 and 3. By accuracy, we mean the amount of right decisions over the total decisions made. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Simplifications</head><p>The shortcoming of this classifier system (including when using the genetic algorithm under incomplete enumeration of rules) is that it gives the results shown above, even when we know that agents of Type 1 should learn to play speculative strategies. We thus began by changing some assumptions as proposed by <ref type="bibr" target="#b0">[1]</ref>, aiming at simplifying the implementation described in Section II-E.</p><p>The first simplification was to eliminate the agent's learning about consumption preferences, as it is more interesting to analyze the agents' trading behavior, while it is realistic to assume that an agent knows what good it should consume.</p><p>After removing the learning of consumption preferences, an interesting fact emerged: it was over-consumption that caused the distributions seen in Figures <ref type="figure" target="#fig_3">3</ref> and<ref type="figure">4</ref>. It turns out that the reason lies behind the nature of the learning classifier system itself. Rules like #0# 0## 1, i.e., "if I don't hold Good 2 and my counterpart does not hold Good 1, then I'm willing to trade", tend to be misleading for an agent, because there are situations in which this is a good rule and situations in which it is not. This situation is depicted in Table <ref type="table">I</ref>, where we extracted information for a specific agent of Type 2 about the classifiers that reflect this situation. Here we expected that the two rules would have both been used a fair amount of times, while instead the one leading to the "no trade" decision has been used only once and then dropped. The rule leading to the "trade" decision has been used 207 times, even if we know that it is not always the best one. This limitation must be taken into account when interpreting the results. From now on, we will consider the results for the classifier system version that includes the genetic algorithm, since it always gives us the best results. This issue notwithstanding, this simplification increases the overall accuracy from ∼75% to an average of 91%, due the disappearance of incorrect consumption decisions. This accuracy is reached when the system is in a state in which every agent should play fundamental strategies. Figure <ref type="figure">5</ref> shows the distributions of goods after removing the consumption classifier system. Fig. <ref type="figure">5</ref>. Distribution after a model run after removing the consumption classifier system (fundamental equilibrium) However, if we set the model with parameters and a distribution of goods that should lead to the use of speculative strategies, we do not get anything different from what we just saw in Figure <ref type="figure">5</ref>, as everybody still plays fundamental. If we consider that they should play speculative strategies, the accuracy of Type 1 agent decisions is only 23%.</p><p>The second simplification is about the choices of Type 2 and 3 agents. As it is the behavior of Type 1 agents only that determines whether Good 3 emerges as money, we can impose that the trading choices of Type 2 and 3 agents always conform with the fundamental strategies. However, this simplification only yields a 3% gain in accuracy, as does making Type 1 agents always accept Good 1 (their consumption good) in order to reduce the amount of noise in the learning process: the system still converges to a fundamental equilibrium like the one depicted in Figure <ref type="figure" target="#fig_5">6</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Loop avoiding</head><p>These results suggest that a deeper cause for the failure of the model to learn speculative behaviors have to be sought for.</p><p>Since the learning process goes through a multitude of unrelated classifiers, agents can be "deceived". For example, a Type 1 agent has to simultaneously learn not to trade Good 2 for 3, and to trade Good 3 for 2. Given the structure of the classifier system, these two learning processes go in parallel and there is no feedback across them. Specifically, learning a Nash strategy is decomposed into learning multiple (in this case two) actions simultaneously and can lead to conflicting actions. More generally, the design of the classifier prevents the agent from forming a global view of the relative trading opportunities and could induce it to miss profitable patterns.</p><p>For this reason, when we reward a rule, we want to remove a fraction of this reward from its opposite rule (which we will call OPP from now on). Our first try was then to subtract/add from OPP's strength half the strength that is respectively added/subtracted from the considered rule. Adding a negative amount to the strength means reducing the possibility for the rule to be chosen. An example of a rule that gets its strength naturally reduced is when an exchange occurs, but there is no consumption: the agent incurs a cost but gets no utility.</p><p>Even though this OPP approach did not solve the problem, it increased the performance by 26%, yielding an accuracy of 59%. The results in Figure <ref type="figure" target="#fig_6">7</ref> may look similar to the ones in Figure <ref type="figure" target="#fig_5">6</ref>, but it can be noticed that we are moving towards the expected distribution of Figure <ref type="figure" target="#fig_2">2</ref>. Since the problem appears to be that contradictory rules can be learned, we should look at its cause, which is payouts are rewarded only after a trading sequence eventually leads to consumption. Every rule that is used pays a bid that is summed to all the other bids from other rules. When consumption occurs, those bids are equally distributed across all classifiers that were involved in the trading process that led to consumption. This leads to the insight that the reason why agents do not learn to play speculative strategies is that these involve longer trading chains, but rules that do not contribute or work against the final outcome are rewarded in the same way as the favorable rules are. This situation happens when there is a complete trade cycle. For instance, say Type 1 agent is holding Good 2 at some period. In the next period, it trades it for Good 3, then later it trades it back to Good 2 and finally it trades for Good 1 and consumes. Now, if the reward is equally distributed over all classifiers, the action to trade Good 2 for Good 3, wich went clearly in the wrong direction, will be rewarded, whereas it should not. How to deal with such situations were never addressed in <ref type="bibr" target="#b9">[10]</ref>.</p><p>We propoese to solve this issue by introducing an exponential smoothing of rewards, which assigns exponentially decreasing weights to older rule firings, according to the following formula:</p><formula xml:id="formula_8">y t+1|t = αy t + α(1 -α)y t-1 + α(1 -α) 2 y t-2 . . . . (4)</formula><p>The one-step-ahead forecast for time t + 1 is a weighted average of all of the past observations in series y 1 , ..., y t . The rate at which the weights decrease is controlled by a smoothing parameter 0 ≤ α ≤ 1. If α is small (i.e., close to 0), more weight is given to observations from the more distant past. If α is large (i.e., close to 1), more weight is given to the more recent observations <ref type="bibr" target="#b13">[14]</ref>. Using this approach, we get the best results with α = 0.8, which yields an 87% of accuracy from Type 1 agents; the results are plotted in Figure <ref type="figure" target="#fig_7">8</ref>. The last step was to avoid the second and third simplifications (see Section III-B), to see if now the agents can learn autonomously when to use a fundamental or speculative strategy. The result is that the average accuracy of decisions when the parameters suggest that all the agents should play fundamental, is still near the one when we removed the consumption classifier (old: 91%; new: 90%). When Type 1 agents should play speculative while Type 2 and 3 agents should play fundamental, the accuracy is now 84%, with a slight reduction from 87%, because now Type 2 and 3 agents can make errors.</p><p>The introduction of the exponential smoothing of rewards seems to be is the key assumption leading to the correct learning of speculative strategies, for it allows a majority of agents to learn the correct strategy also when a speculative equilibrium is optimal.</p><p>IV. CONCLUSIONS We investigated why, in the models of <ref type="bibr" target="#b0">[1]</ref> and <ref type="bibr" target="#b9">[10]</ref>, agents did not always learn speculative strategies. We identified an issue with the distribution of rewards along the classifiers involved in a chain of trades. The exponential smooting of rewards appears to be the key factor responsible for the model being able to reproduce speculative behavior as expected.</p><p>While the modified model reaches a satisfactory level of accuracy (87%), it is still not perfect. Other adjustments might enable it model to get even closer to 100% accuracy. One promising approach would be to increas the expressivity of the classifiers, for instance to enable them to recognize which type of agent the counterpart is. Indeed, rules that prove to be beneficial when trading with one type of agent may turn out to be deleterious when trading with another type of agent.</p><p>Investigating the influence of the size of the economy (i.e., the number of agents) and different mixes of the three types on the convergence to the equilibria is another interesting direction, as are various generalizations of the model.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Distribution of goods for the three agents using fundamental strategies.</figDesc><graphic coords="5,132.58,477.26,80.34,59.69" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>, 1). This means</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Distribution of goods for the three types of agents when agents of Type 1 play speculative while Type 2 and 3 play fundamental.</figDesc><graphic coords="5,395.59,50.54,80.34,59.93" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. Distribution after a model run using only classifier system</figDesc><graphic coords="5,396.08,352.99,82.85,61.30" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>AND FIRING COUNT OF TWO SAMPLE RULES OF A TYPE 2 AGENT, WITH ANTECEDENT #0# 0## AND TWO OPPOSITE CONSEQUENTS (DECISIONS).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 6 .</head><label>6</label><figDesc>Fig. 6. Distribution after a model run after applying all the simplifications</figDesc><graphic coords="6,396.08,87.67,82.85,61.47" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 7 .</head><label>7</label><figDesc>Fig. 7. Distribution after a model run after with OPP update</figDesc><graphic coords="6,396.08,537.33,82.85,61.42" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 8 .</head><label>8</label><figDesc>Fig. 8. Distribution after a model run after applying exponential smoothing with α = 0.8</figDesc><graphic coords="7,50.22,393.86,82.85,61.67" type="bitmap" /></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">The Emergence of Money: Computational Approaches with Fully and Boundedly Rational Agents</title>
		<author>
			<persName><forename type="first">Zakaria</forename><surname>Babutsidze</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Maurizio</forename><surname>Iacopetta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computational Economics</title>
		<imprint>
			<date type="published" when="2019-03">March 2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Dynamic Programming and Stochastic Control</title>
		<author>
			<persName><forename type="first">Dimitri</forename><forename type="middle">P</forename><surname>Bertsekas</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1976">1976</date>
			<publisher>Academic Press, Inc</publisher>
			<pubPlace>USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A dynamic analysis of Nash equilibria in search models with fiat money</title>
		<author>
			<persName><forename type="first">F</forename><surname>Bonetto</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Iacopetta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Mathematical Economics</title>
		<imprint>
			<biblScope unit="volume">84</biblScope>
			<biblScope unit="issue">C</biblScope>
			<biblScope unit="page" from="207" to="224" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Emergence of money as a medium of exchange: An experimental study</title>
		<author>
			<persName><forename type="first">John</forename><surname>Duffy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jack</forename><surname>Ochs</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">American Economic Review</title>
		<imprint>
			<biblScope unit="volume">89</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="847" to="877" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Genetic Algorithms in Search, Optimization &amp; Machine Learning</title>
		<author>
			<persName><forename type="first">David</forename><forename type="middle">E</forename><surname>Goldberg</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1989">1989</date>
			<publisher>Addison-Wesley</publisher>
			<pubPlace>Reading, MA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Adaptation in Natural and Artificial Systems</title>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">H</forename><surname>Holland</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1975">1975</date>
			<publisher>The University of Michigan Press</publisher>
			<pubPlace>Ann Arbor</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">The emergence of money: A dynamic analysis</title>
		<author>
			<persName><forename type="first">Maurizio</forename><surname>Iacopetta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Macroeconomic Dynamics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="2573" to="2596" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">On money as a medium of exchange</title>
		<author>
			<persName><forename type="first">Nobuhiro</forename><surname>Kiyotaki</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Randall</forename><surname>Wright</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Political Economy</title>
		<imprint>
			<biblScope unit="volume">97</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="927" to="954" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A doubly structural network model and analysis on the emergence of money</title>
		<author>
			<persName><forename type="first">Masaaki</forename><surname>Kunigami</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Masato</forename><surname>Kobayashi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Satoru</forename><surname>Yamadera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Takashi</forename><surname>Yamada</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Takao</forename><surname>Terano</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Simulating Interacting Agents and Social Phenomena</title>
		<imprint>
			<publisher>Springer Japan</publisher>
			<date type="published" when="2010">2010</date>
			<biblScope unit="page" from="137" to="149" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Money as a medium of exchange in an economy with artificially intelligent agents</title>
		<author>
			<persName><forename type="first">Ramon</forename><surname>Marimon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ellen</forename><surname>Mcgrattan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Thomas</forename><surname>Sargent</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Economic Dynamics and Control</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="329" to="373" />
			<date type="published" when="1990">1990</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">On the origins of money</title>
		<author>
			<persName><forename type="first">Carl</forename><surname>Menger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">History of Economic Thought Articles</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="239" to="255" />
			<date type="published" when="1892">1892</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Trading agent competition with autonomous economic agents</title>
		<author>
			<persName><forename type="first">David</forename><surname>Minarsch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marco</forename><surname>Favorito</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ali</forename><surname>Hosseini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jonathan</forename><surname>Ward</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">AAMAS</title>
		<imprint>
			<publisher>International Foundation for Autonomous Agents and Multiagent Systems</publisher>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="2107" to="2110" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<author>
			<persName><forename type="first">André</forename><surname>Orléan</surname></persName>
		</author>
		<title level="m">The Origin of Money</title>
		<meeting><address><addrLine>Netherlands; Dordrecht</addrLine></address></meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="1992">1992</date>
			<biblScope unit="page" from="113" to="143" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Simple exponential smoothing</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Truthfulness on a budget: trading money for approximation through monitoring</title>
		<author>
			<persName><forename type="first">Paolo</forename><surname>Serafino</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Carmine</forename><surname>Ventre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Angelina</forename><surname>Vidali</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Auton. Agents Multi Agent Syst</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">5</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Save money or feel cozy?: A field experiment evaluation of a smart thermostat that learns heating preferences</title>
		<author>
			<persName><forename type="first">Mike</forename><surname>Shann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alper</forename><forename type="middle">T</forename><surname>Alan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sven</forename><surname>Seuken</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Enrico</forename><surname>Costanza</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sarvapali</forename><forename type="middle">D</forename><surname>Ramchurn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">AAMAS</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="1008" to="1016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Agent-based computational economics: modeling economies as complex adaptive systems</title>
		<author>
			<persName><forename type="first">Leigh</forename><surname>Tesfatsion</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Information Sciences</title>
		<imprint>
			<biblScope unit="volume">149</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="263" to="269" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Learning classifier systems: A complete introduction, review, and roadmap</title>
		<author>
			<persName><forename type="first">Ryan</forename><surname>Urbanowicz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jason</forename><surname>Moore</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Artificial Evolution and Applications</title>
		<imprint>
			<biblScope unit="page">9</biblScope>
			<date type="published" when="2009">2009. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">The emergence and collapse of money</title>
		<author>
			<persName><forename type="first">Ayumu</forename><surname>Yasutomi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physica D: Nonlinear Phenomena</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="180" to="194" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
